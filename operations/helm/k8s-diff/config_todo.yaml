---
patch_rules:

- name: "Helm disables multitenancy"
  todo: true
  remove_field: /multitenancy_enabled

- name: "Helm server settings"
  todo: true
  remove_field: /server/grpc_server_max_concurrent_streams
- name: "Helm server settings"
  todo: true
  remove_field: /server/grpc_server_max_recv_msg_size
- name: "Helm server settings"
  todo: true
  remove_field: /server/grpc_server_max_send_msg_size

- name: "Helm disabled memberlist compression"
  todo: true
  remove_field: /memberlist/compression_enabled

- name: "Helm aligns queries with step"
  todo: true
  /target: [query-frontend]
  remove_field: /frontend/align_queries_with_step

- name: "Helm logs long queries"
  todo: true
  /target: [query-frontend]
  remove_field: /frontend/log_queries_longer_than


- name: "Jsonnet compactor ring stability duration"
  todo: true
  /target: [compactor]
  remove_field: /compactor/sharding_ring/wait_stability_min_duration

- name: "Jsonnet store-gateway ring stability duration"
  todo: true
  /target: [store-gateway]
  remove_field: /store_gateway/sharding_ring/wait_stability_min_duration

- name: "Jsonnet store-gateway ignore blocks within"
  todo: true
  /target: [store-gateway]
  remove_field: /blocks_storage/bucket_store/ignore_blocks_within

- name: "Jsonnet store-gateway caches"
  todo: true
  /target: [store-gateway]
  remove_field: /blocks_storage/bucket_store/index_cache/memcached/max_item_size
- name: "Jsonnet store-gateway caches"
  todo: true
  /target: [store-gateway]
  remove_field: /blocks_storage/bucket_store/chunks_cache/attributes_in_memory_max_items
- name: "Jsonnet store-gateway caches"
  todo: true
  /target: [store-gateway]
  remove_field: /blocks_storage/bucket_store/max_chunk_pool_bytes

- name: "Jsonnet query path parameters"
  todo: true
  /target: [ruler]
  remove_field: /querier/query_store_after
- name: "Jsonnet query path parameters"
  todo: true
  /target: [ruler, querier]
  remove_field: /limits/max_query_length

- name: "Jsonnet query path parameters"
  todo: true
  /target: [querier]
  remove_field: /querier/max_concurrent
- name: "Jsonnet query path parameters"
  todo: true
  /target: [querier]
  remove_field: /querier/query_store_after

- name: "Jsonnet query path parameters, query frontend has longer max_query_length"
  todo: true
  /target: [query-frontend]
  remove_field: /limits/max_query_length

- name: "Jsonnet sets smaller ruler limits"
  todo: true
  /target: [ruler, overrides-exporter]
  remove_field: /limits/ruler_max_rule_groups_per_tenant

- name: "Jsonnet sets higher ring heartbeat timeout"
  todo: true
  /target: [ruler]
  remove_field: /ingester/ring/heartbeat_timeout

- name: "Jsonnet enables query frontend results cache"
  todo: true
  /target: [query-frontend]
  remove_field: /frontend/cache_results
- name: "Jsonnet enables query frontend results cache"
  todo: true
  /target: [query-frontend]
  remove_field: /frontend/results_cache/backend
- name: "Jsonnet enables query frontend results cache"
  todo: true
  /target: [query-frontend]
  remove_field: /frontend/results_cache/memcached/timeout
- name: "Jsonnet enables query frontend results cache"
  todo: true
  /target: [query-frontend]
  remove_field: /limits/max_cache_freshness

- name: "Jsonnet query-frontend & querier has longer server_write_timeout"
  todo: true
  /target: [query-frontend, querier]
  remove_field: /server/http_server_write_timeout

- name: "Jsonnet disables query isolation (Mimir 2.1 will include this by default)"
  todo: true
  /target: [ingester]
  remove_field: /blocks_storage/tsdb/isolation_enabled

- name: "Jsonnet sets different ingester ring options"
  todo: true
  /target: [ingester]
  remove_field: /ingester/ring/heartbeat_period
- name: "Jsonnet sets different ingester ring options"
  todo: true
  /target: [ingester, distributor]
  remove_field: /ingester/ring/heartbeat_timeout
- name: "Jsonnet sets different ingester ring options"
  todo: true
  /target: [ingester]
  remove_field: /ingester/ring/readiness_check_ring_health

- name: "Jsonnet enables HA tracker"
  todo: true
  /target: [distributor]
  remove_field: /distributor/ha_tracker/enable_ha_tracker
- name: "Jsonnet enables HA tracker"
  todo: true
  /target: [distributor]
  remove_field: /distributor/ha_tracker/kvstore/store
- name: "Jsonnet enables HA tracker"
  todo: true
  /target: [distributor]
  remove_field: /limits/accept_ha_samples

- name: "Jsonnet sets special grpc connection settings on the distributor"
  todo: true
  /target: [distributor]
  remove_field: /server/grpc_server_max_connection_age
- name: "Jsonnet sets special grpc connection settings on the distributor"
  todo: true
  /target: [distributor]
  remove_field: /server/grpc_server_max_connection_age_grace
- name: "Jsonnet sets special grpc connection settings on the distributor"
  todo: true
  /target: [distributor]
  remove_field: /server/grpc_server_max_connection_idle

- name: "Jsonnet tunes the compactor"
  todo: true
  /target: [compactor]
  remove_field: /compactor/compaction_interval
- name: "Jsonnet tunes the compactor"
  todo: true
  /target: [compactor]
  remove_field: /compactor/deletion_delay
- name: "Jsonnet tunes the compactor"
  todo: true
  /target: [compactor]
  remove_field: /compactor/max_closing_blocks_concurrency
- name: "Jsonnet tunes the compactor"
  todo: true
  /target: [compactor]
  remove_field: /compactor/max_opening_blocks_concurrency
- name: "Jsonnet tunes the compactor"
  todo: true
  /target: [compactor]
  remove_field: /compactor/symbols_flushers_concurrency
- name: "Jsonnet tunes the compactor"
  todo: true
  /target: [compactor]
  remove_field: /limits/compactor_tenant_shard_size

- name: "Helm uses memberlist for alertmanager ring"
  todo: true
  /target: [alertmanager]
  remove_field: /memberlist